---
title: Inputs
description: sf-tractomics inputs
---

import { FileTree } from '@astrojs/starlight/components';
import { Tabs, TabItem } from '@astrojs/starlight/components';

### Default input format - BIDS

`sf-tractomics` input folder must follow a valid [BIDS](https://bids-specification.readthedocs.io/en/stable/) format,
that minimally contains **diffusion** (**dwi**) and **T1-weighted** (**T1w**) MRI acquisitions :

<FileTree>
  * input\_bids\_directory
    * dataset_description.json
    * sub-01
      * dwi
        * sub-01\_dwi.nii.gz
        * sub-01\_dwi.bval
        * sub-01\_dwi.bvec
        * sub-01\_dwi.json
      * anat
        * sub-01\_T1w.nii.gz
        * sub-01\_T1w.json
    * sub-02
      * dwi
        * sub-02\_dwi.nii.gz
        * sub-02\_dwi.bval
        * sub-02\_dwi.bvec
        * sub-02\_dwi.json
      * anat
        * sub-02\_T1w.nii.gz
        * sub-02\_T1w.json
</FileTree>

### Perform Motion and Eddy currents correction

`sf-tractomics` automatically detects **reverse-phase** acquired images and **epi** references from the BIDS dataset
organization. To be detected, those images need to have a valid [direction](https://bids-specification.readthedocs.io/en/stable/appendices/entities.html#dir)
entity. The same is expected for the main diffusion volume as well (**AP** and **PA** are used as example) :

<Tabs>

<TabItem label="Reverse b0">

<FileTree>
  * input\_bids\_directory
    * dataset_description.json
    * sub-01
      * dwi
        * sub-01\_dir-AP\_dwi.nii.gz
        * sub-01\_dir-AP\_dwi.bval
        * sub-01\_dir-AP\_dwi.bvec
        * sub-01\_dir-AP\_dwi.json
      * anat
        * sub-01\_T1w.nii.gz
        * sub-01\_T1w.json
      * epi
        * sub-01\_dir-PA\_sbref.nii.gz
        * sub-01\_dir-PA\_sbref.json
    * sub-02
      * dwi
        * sub-02\_dir-AP\_dwi.nii.gz
        * sub-02\_dir-AP\_dwi.bval
        * sub-02\_dir-AP\_dwi.bvec
        * sub-02\_dir-AP\_dwi.json
      * anat
        * sub-02\_T1w.nii.gz
        * sub-02\_T1w.json
      * epi
        * sub-02\_dir-PA\_sbref.nii.gz
        * sub-02\_dir-PA\_sbref.json
</FileTree>

</TabItem>

<TabItem label="Reverse DWI">

:::caution[Gradient protocols must fit !]
The correction only works if you provide the **exact same gradient protocol** for both DWI
volumes
:::

<FileTree>
  * input\_bids\_directory
    * dataset_description.json
    * sub-01
      * dwi
        * sub-01\_dir-AP\_dwi.nii.gz
        * sub-01\_dir-AP\_dwi.bval
        * sub-01\_dir-AP\_dwi.bvec
        * sub-01\_dir-AP\_dwi.json
        * sub-01\_dir-PA\_dwi.nii.gz
        * sub-01\_dir-PA\_dwi.bval
        * sub-01\_dir-PA\_dwi.bvec
        * sub-01\_dir-PA\_dwi.json
      * anat
        * sub-01\_T1w.nii.gz
        * sub-01\_T1w.json
    * sub-02
      * dwi
        * sub-02\_dir-AP\_dwi.nii.gz
        * sub-02\_dir-AP\_dwi.bval
        * sub-02\_dir-AP\_dwi.bvec
        * sub-02\_dir-AP\_dwi.json
        * sub-02\_dir-PA\_dwi.nii.gz
        * sub-02\_dir-PA\_dwi.bval
        * sub-02\_dir-PA\_dwi.bvec
        * sub-02\_dir-PA\_dwi.json
      * anat
        * sub-02\_T1w.nii.gz
        * sub-02\_T1w.json
</FileTree>

</TabItem>

</Tabs>

### Unstructured datasets

`sf-tractomics` also supports parsing its input from a `samplesheet.csv` in **C**omma **S**eparated **V**alues format, in case
your dataset doesn't follow the BIDS format yet. The samplesheet must respect the header below :

```csv
subject,dwi,bval,bvec,sbref,rev_dwi,rev_bval,rev_bvec,rev_sbref,t1,wmparc,aparc_aseg,lesion
```

|||
|-|-|
| subject | Identifier to tag the subject's files when producing outputs|
| dwi | Diffusion Weighted volume in Nifti format|
| bval | b-values file following FSL format|
| bvec | b-vectors file following FSL format|
| sbref | Single-band b0 reference for the DWI volume in Nifti format|
| rev_dwi | Reverse-phase acquired Diffusion Weighted volume in Nifti format|
| rev_bval | b-values file for the reverse-phase DWI following FSL format|
| rev_bvec | b-vectors file for the reverse-phase DWI following FSL format|
| rev_sbref | Single-band b0 reference for the reverse-phase DWI volume in Nifti format|
| t1 | Anatomical T1-Weighted volume in Nifti format|
| wmparc | White matter parcellation from _FreeSurfer_|
| aparc_aseg | Tissue segmentation and cortical parcellation from _FreeSurfer_|

Example of a `samplesheet.csv` file:

```csv
subject,dwi,bval,bvec,sbref,rev_dwi,rev_bval,rev_bvec,rev_sbref,t1,wmparc,aparc_aseg,lesion
sub-01_ses-1,/my/path/to/data/sub-01/dwi.nii.gz,/my/path/to/data/sub-01/dwi.bval,/my/path/to/data/sub-01/dwi.bvec,,,,,/my/path/to/data/sub-01/t1.nii.gz,/my/path/to/data/sub-01/wmparc.nii.gz,/my/path/to/data/sub-01/aparc+aseg.nii.gz,
sub-02,/my/path/to/data/sub-02/dwi_ap.nii.gz,/my/path/to/data/sub-02/dwi_ap.bval,/my/path/to/data/sub-02/dwi_ap.bvec,,/my/path/to/data/sub-02/dwi_pa.nii.gz,/my/path/to/data/sub-02/dwi_pa.bval,/my/path/to/data/sub-02/dwi_pa.bvec,/my/path/to/data/sub-02/t1.nii.gz,/my/path/to/data/sub-02/wmparc.nii.gz,/my/path/to/data/sub-02/aparc+aseg.nii.gz,
sub-03,/my/path/to/data/sub-03/dwi_ap.nii.gz,/my/path/to/data/sub-03/dwi_ap.bval,/my/path/to/data/sub-03/dwi_ap.bvec,,/my/path/to/data/sub-03/dwi_pa.nii.gz,/my/path/to/data/sub-03/dwi_pa.bval,/my/path/to/data/sub-03/dwi_pa.bvec,/my/path/to/data/sub-03/t1.nii.gz,,,
```
